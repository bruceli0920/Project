{"version":3,"sources":["list.js"],"names":["createList","arr","i","length","status","json","undefined","releaseStatus1","icon","iata","airlineCode","oLi","$","identification","iataCn","fltNo","sdtTime","startAirportNameCn","destSdtTime","destAirportNameCn","appendTo","color","getStateColor","find","css","background","backgroundSize","document","ready","bFlag","type","getUrlQueryString","arrdep","dateStr","token","sessionStorage","getItem","flightJson","cityJson","url","data","flightNo","date","arrOrDep","success","hide","show","ajaxBase","startStation","endStation","airLine","pageNum","pageCount","rst","lastPage","on","fltId","this","attr","window","location","href","oList","scroll","scrollTop","clientHeight","documentElement","body","top","outerHeight"],"mappings":"AAuFA,QAASA,YAAWC,GACnB,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAIE,OAAQD,IAAK,CACpC,GACIE,GADAC,EAAOJ,EAAIC,EAGdE,OAD0BE,IAAvBD,EAAKE,eACC,KAEAF,EAAKE,cAEf,IAAIC,OACaF,IAAbD,EAAKI,KACRD,EAAOH,EAAKI,SACkBH,IAApBD,EAAKK,cACfF,EAAOH,EAAKK,YAEb,IAAIC,GAAMC,EAAE,kBAAoBP,EAAKQ,eAAiB,qEAGlCR,EAAKS,OAASN,EAAOH,EAAKU,MAAQ,0EAKhCV,EAAKW,QAAU,uBACfX,EAAKY,mBAAqB,kCAErBb,EAAS,uCAEdC,EAAKa,YAAc,uBACnBb,EAAKc,kBAAoB,oDAK/CR,GAAIS,SAASR,EAAE,YACf,IAAIS,GAAQC,cAAclB,EAC1BO,GAAIY,KAAK,WAAWC,KACnBH,MAAOA,IAERV,EAAIY,KAAK,gBAAgBC,KACxBC,WAAc,cAAgBjB,EAAO,kBACrCkB,eAAkB,aA/HrBd,EAAEe,UAAUC,MAAM,WACjB,GAAIC,IAAQ,EACRC,EAAOC,kBAAkB,QACzBC,EAASD,kBAAkB,UAC3BE,EAAUF,kBAAkB,WAC5BG,EAAQC,eAAeC,QAAQ,SAG/BC,KACAC,IACJ,IAAY,UAARR,EAAkB,CAErBO,GACCE,IAAK,6EAA+EL,EACpFM,MACCC,SAJaV,kBAAkB,YAK/BW,KAAQT,EACRU,SAAYX,GAEbY,QAAS,SAAUJ,GACdA,GAAuB,GAAfA,EAAKrC,QAChB0B,GAAQ,EACR7B,WAAWwC,KAEX5B,EAAE,QAAQiC,OACVjC,EAAE,aAAakC,UAIlBC,SAASV,GAAY,OACf,IAAY,QAARP,EAAgB,CAC1B,GAAIkB,GAAejB,kBAAkB,gBACjCkB,EAAalB,kBAAkB,cAC/BmB,EAAUnB,kBAAkB,UAChCO,IACCC,IAAK,4EAA8EL,EACnFM,MACCQ,aAAgBA,EAChBC,WAAcA,EACdP,KAAQT,EACRU,SAAYX,EACZmB,QAnCW,EAoCXC,UAnCa,GAoCbF,QAAWA,GAEZN,QAAS,SAAUJ,GACdA,GAAuB,GAAfA,EAAKrC,QAChB0B,GAAQ,EACR7B,WAAWwC,EAAKa,MACZb,EAAKc,UAA+B,GAAnBd,EAAKa,IAAIlD,UAC7B0B,GAAQ,EACRjB,EAAE,QAAQiC,OACVjC,EAAE,aAAakC,UAGhBlC,EAAE,QAAQiC,OACVjC,EAAE,aAAakC,UAIlBC,SAAST,GAAU,GAEpB1B,EAAE,YAAY2C,GAAG,QAAS,KAAM,WAC/B,GAAIC,GAAQ5C,EAAE6C,MAAMC,KAAK,aACzBC,QAAOC,SAASC,KAAO,qBAAuBL,EAAQ,WAAaxB,GAEpE,IAAI8B,GAAQlD,EAAE,QACJA,GAAE,WACZA,GAAEe,UAAUoC,OAAO,WAClB,GAAIC,GAAYpD,EAAEe,UAAUqC,YACxBC,EAAetC,SAASuC,gBAAkBvC,SAASuC,gBAAgBD,aAAetC,SAASwC,KAAKF,aAChGG,EAAMN,EAAMO,aACLzD,GAAE,UACLoD,GAAYC,EACZ,KAAOG,GAAOJ,EAAY,KAC7BnC,IACHA,GAAQ,EACI,QAARC,IACHQ,EAASE,KAAKW,UACdJ,SAAST,GAAU","file":"../list.js","sourcesContent":["//var arrdep=getUrlQueryString('arrdep');\r\n$(document).ready(function () {\r\n\tvar bFlag = true;\r\n\tvar type = getUrlQueryString('type');\r\n\tvar arrdep = getUrlQueryString('arrdep');\r\n\tvar dateStr = getUrlQueryString('dateStr');\r\n\tvar token = sessionStorage.getItem('token');\r\n\tvar pageNum = 1;\r\n\tvar pageCount = 10;\r\n\tvar flightJson = {};\r\n\tvar cityJson = {};\r\n\tif (type == 'flight') {\r\n\t\tvar flightNo = getUrlQueryString('flightNo');\r\n\t\tflightJson = {\r\n\t\t\turl: 'http://airtest.rtmap.com/service-api/flight/selectByFlightNoAndDate?token=' + token,\r\n\t\t\tdata: {\r\n\t\t\t\t\"flightNo\": flightNo,\r\n\t\t\t\t\"date\": dateStr,\r\n\t\t\t\t\"arrOrDep\": arrdep\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (data && data.length != 0) {\r\n\t\t\t\t\tbFlag = true;\r\n\t\t\t\t\tcreateList(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('.msg').hide();\r\n\t\t\t\t\t$('.msg.none').show()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tajaxBase(flightJson, false);\r\n\t} else if (type == 'city') {\r\n\t\tvar startStation = getUrlQueryString('startStation');\r\n\t\tvar endStation = getUrlQueryString('endStation');\r\n\t\tvar airLine = getUrlQueryString('airLine');\r\n\t\tcityJson = {\r\n\t\t\turl: 'http://airtest.rtmap.com/service-api/flight/selectByStationAndDate?token=' + token,\r\n\t\t\tdata: {\r\n\t\t\t\t\"startStation\": startStation,\r\n\t\t\t\t\"endStation\": endStation,\r\n\t\t\t\t\"date\": dateStr,\r\n\t\t\t\t\"arrOrDep\": arrdep,\r\n\t\t\t\t\"pageNum\": pageNum,\r\n\t\t\t\t\"pageCount\": pageCount,\r\n\t\t\t\t\"airLine\": airLine\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (data && data.length != 0) {\r\n\t\t\t\t\tbFlag = true;\r\n\t\t\t\t\tcreateList(data.rst);\r\n\t\t\t\t\tif (data.lastPage || data.rst.length == 0) {\r\n\t\t\t\t\t\tbFlag = false;\r\n\t\t\t\t\t\t$('.msg').hide();\r\n\t\t\t\t\t\t$('.msg.none').show()\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('.msg').hide();\r\n\t\t\t\t\t$('.msg.none').show()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tajaxBase(cityJson, false);\r\n\t}\r\n\t$('.list ul').on('click', 'li', function () {\r\n\t\tvar fltId = $(this).attr('data-fltId');\r\n\t\twindow.location.href = 'detail.html?fltId=' + fltId + '&arrdep=' + arrdep;\r\n\t});\r\n\tvar oList = $('.list');\r\n\tvar oUl = $('.list ul');\r\n\t$(document).scroll(function () {\r\n\t\tvar scrollTop = $(document).scrollTop();\r\n\t\tvar clientHeight = document.documentElement ? document.documentElement.clientHeight : document.body.clientHeight;\r\n\t\tvar top = oList.outerHeight();\r\n\t\tvar aBtn = $('.tab li');\r\n\t\tvar h = scrollTop + clientHeight;\r\n\t\tif (h + 100 >= top && scrollTop > 100) {\r\n\t\t\tif (bFlag) {\r\n\t\t\t\tbFlag = false;\r\n\t\t\t\tif (type == 'city') {\r\n\t\t\t\t\tcityJson.data.pageNum++;\r\n\t\t\t\t\tajaxBase(cityJson, false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n});\r\n\r\nfunction createList(arr) {\r\n\tfor (var i = 0; i < arr.length; i++) {\r\n\t\tvar json = arr[i];\r\n\t\tvar status;\r\n\t\tif (json.releaseStatus1 == undefined) {\r\n\t\t\tstatus = '计划';\r\n\t\t} else {\r\n\t\t\tstatus = json.releaseStatus1;\r\n\t\t}\r\n\t\tvar icon;\r\n\t\tif (json.iata != undefined) {\r\n\t\t\ticon = json.iata;\r\n\t\t} else if (json.airlineCode != undefined) {\r\n\t\t\ticon = json.airlineCode;\r\n\t\t}\r\n\t\tvar oLi = $('<li data-fltId=' + json.identification + '>' +\r\n\t\t\t'<div class=\"title clearfix\">' +\r\n\t\t\t'<i class=\"icon fl\"></i>' +\r\n\t\t\t'<p class=\"fl\">' + json.iataCn + icon + json.fltNo + '</p>' +\r\n\t\t\t// '<span class=\"fr\">详情</span>'+\r\n\t\t\t'</div>' +\r\n\t\t\t'<div class=\"detail clearfix\">' +\r\n\t\t\t'<div class=\"fl\">' +\r\n\t\t\t'<p class=\"time\">' + json.sdtTime + '</p>' +\r\n\t\t\t'<p class=\"city\">' + json.startAirportNameCn + '</p>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'<p class=\"status fl\">' + status + '</p>' +\r\n\t\t\t'<div class=\"fl\">' +\r\n\t\t\t'<p class=\"time\">' + json.destSdtTime + '</p>' +\r\n\t\t\t'<p class=\"city\">' + json.destAirportNameCn + '</p>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'<div class=\"view\">查看详情</div>' +\r\n\t\t\t'</li>');\r\n\t\toLi.appendTo($('.list ul'));\r\n\t\tvar color = getStateColor(status);\r\n\t\toLi.find('.status').css({\r\n\t\t\tcolor: color\r\n\t\t});\r\n\t\toLi.find('.title .icon').css({\r\n\t\t\t'background': 'url(images/' + icon + '.gif) no-repeat',\r\n\t\t\t'backgroundSize': 'contain'\r\n\t\t});\r\n\t}\r\n}"]}