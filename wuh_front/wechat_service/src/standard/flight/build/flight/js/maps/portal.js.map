{"version":3,"sources":["portal.js"],"names":["createDate","json","$","time","sClass","day","mon","appendTo","formatsTime","monArr","oDate","Date","setTime","getMonth","getDate","follow","console","log","dep","depList","arr","arrList","list","arrdep","q","push","k","i","code","airlineCode","iata","flt","fltNo","status","undefined","releaseStatus1","oLi","identification","iataCn","sdtTime","startAirportNameCn","destSdtTime","destAirportNameCn","color","getStateColor","find","css","background","backgroundSize","document","ready","dialogA","Dialog","init","token","sessionStorage","getItem","getUrlQueryString","setSessionValue","reverse","monthIndex","val","attr","data-code","removeClass","eq","addClass","show","each","index","this","on","timeJson","url","success","data","ajaxBase","hide","Math","floor","parents","oCont","year","getFullYear","dateStr","hasClass","flightNo","test","window","location","href","setValue","startStation","endStation","airLine","search","setItem","fltId"],"mappings":"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","file":"../portal.js","sourcesContent":["$(document).ready(function () {\r\n\tdialogA = Dialog.init('alert');\r\n\t// var city = getUrlQueryString('city');\r\n\t// var cityCode = getUrlQueryString('cityCode');\r\n\t// var company = getUrlQueryString('company');\r\n\t// var companyCode = getUrlQueryString('companyCode');\r\n\tvar token = sessionStorage.getItem('token') || getUrlQueryString('token') || \"9999\";\r\n\tsetSessionValue('token', token);\r\n\tvar reverse = sessionStorage.getItem('reverse') || \"false\";\r\n\tsetSessionValue('reverse', reverse);\r\n\tvar monthIndex = sessionStorage.getItem('month') || '';\r\n\tsetSessionValue('month', monthIndex);\r\n\r\n\t// if (city) {\r\n\t// \t$('.select').val(city);\r\n\t// \t$('.select').attr({\r\n\t// \t\t'data-code': cityCode\r\n\t// \t});\r\n\t// \t$('.tab li').removeClass('active');\r\n\t// \t$('.tab li').eq(1).addClass('active');\r\n\t// \t$('.cont').removeClass('active');\r\n\t// \t$('.cont').eq(1).addClass('active');\r\n\r\n\t// }\r\n\t// if (company) {\r\n\t// \t$('.company input').val(company);\r\n\t// \t$('.company input').attr({\r\n\t// \t\t'data-code': companyCode\r\n\t// \t});\r\n\t// \t$('.company span').show();\r\n\t// \t$('.tab li').removeClass('active');\r\n\t// \t$('.tab li').eq(1).addClass('active');\r\n\t// \t$('.cont').removeClass('active');\r\n\t// \t$('.cont').eq(1).addClass('active');\r\n\t// }\r\n\tif (sessionStorage.getItem('city')) {\r\n\t\t$('.select').val(sessionStorage.getItem('city'));\r\n\t\t$('.select').attr({\r\n\t\t\t'data-code': sessionStorage.getItem('cityCode')\r\n\t\t});\r\n\t\t$('.tab li').removeClass('active');\r\n\t\t$('.tab li').eq(1).addClass('active');\r\n\t\t$('.cont').removeClass('active');\r\n\t\t$('.cont').eq(1).addClass('active');\r\n\t}\r\n\tif (sessionStorage.getItem('company')) {\r\n\t\t$('.depart input').val('重庆');\r\n\t\t$('#company').val(sessionStorage.getItem('company'));\r\n\t\t$('#company').attr({\r\n\t\t\t'data-code': sessionStorage.getItem('companyCode')\r\n\t\t});\r\n\t\t$('.company span').show();\r\n\t\t$('.tab li').removeClass('active');\r\n\t\t$('.tab li').eq(1).addClass('active');\r\n\t\t$('.cont').removeClass('active');\r\n\t\t$('.cont').eq(1).addClass('active');\r\n\t}\r\n\tif (sessionStorage.getItem('company') == \"null\") {\r\n\t\t$(\"#company\").val('');\r\n\t};\r\n\tif (sessionStorage.getItem('reverse') == \"true\") {\r\n\t\t$('.address .depart input').appendTo($('.address .dest'));\r\n\t\t$('.address .dest input').eq(0).appendTo($('.address .depart'));\r\n\t} else {};\r\n\r\n\t// console.log(\r\n\t// \tsessionStorage.getItem('city'),\r\n\t// \tsessionStorage.getItem('cityCode'),\r\n\t// \tsessionStorage.getItem('company'),\r\n\t// \tsessionStorage.getItem('companyCode'),\r\n\t// \tsessionStorage.getItem('reverse'));\r\n\t//导航页签切换\r\n\t$('.tab li').each(function (index) {\r\n\t\t$(this).on('click', function () {\r\n\t\t\t$('.tab li').removeClass('active');\r\n\t\t\t$(this).addClass('active');\r\n\t\t\t$('.cont').removeClass('active');\r\n\t\t\t$('.cont').eq(index).addClass('active');\r\n\t\t\tif (index == 2) {\r\n\t\t\t\tvar timeJson = {\r\n\t\t\t\t\turl: 'http://airtest.rtmap.com/service-api/subscribe/getFollowList?token=' + token,\r\n\t\t\t\t\tsuccess: function (data) {\r\n\t\t\t\t\t\tfollow(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tajaxBase(timeJson);\r\n\t\t\t\t$('.btn').hide();\r\n\t\t\t} else {\r\n\t\t\t\t$('.btn').show();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\t//日期\r\n\tvar timeJson = {\r\n\t\turl: 'http://airtest.rtmap.com/service-api/flight/getServerTime?token=' + token,\r\n\t\tsuccess: function (data) {\r\n\t\t\tvar time = Math.floor(data.time);\r\n\t\t\tfor (var i = -1; i < 2; i++) {\r\n\t\t\t\tvar json;\r\n\t\t\t\tif (i == 0) {\r\n\t\t\t\t\tjson = formatsTime(time, 'active');\r\n\t\t\t\t\t// setSessionValue('month', '0');\r\n\t\t\t\t} else if (i == 1) {\r\n\t\t\t\t\tjson = formatsTime(time + i * 86400000, 'none');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjson = formatsTime(time + i * 86400000, '');\r\n\t\t\t\t};\r\n\t\t\t\tcreateDate(json);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tajaxBase(timeJson, false);\r\n\t//出发到达日期切换\r\n\t$('.date .arrdep li').on('click', function () {\r\n\t\t$('.date .arrdep li').removeClass('active');\r\n\t\t$(this).addClass('active');\r\n\t});\r\n\t$('.date .time').on('click', 'li', function () {\r\n\t\tvar oParent = $(this).parents('.cont');\r\n\t\toParent.find('.date .time li').removeClass('active');\r\n\t\t$(this).addClass('active');\r\n\t\t// if ($('.date').parents('.cont').attr('class') == 'cont city active') {\r\n\t\t// \tconsole.log(1);\r\n\t\t// \tsetSessionValue('month', Number($(this).index()) - 1);\r\n\t\t// };\r\n\t});\r\n\t//切换按钮\r\n\t$('.city .address .cut').on('click', function () {\r\n\t\tif (sessionStorage.getItem('reverse') == \"false\") {\r\n\t\t\tsetSessionValue('reverse', \"true\");\r\n\t\t} else {\r\n\t\t\tsetSessionValue('reverse', \"false\");\r\n\t\t};\r\n\t\t$('.address .depart input').appendTo($('.address .dest'));\r\n\t\t$('.address .dest input').eq(0).appendTo($('.address .depart'));\r\n\t});\r\n\t//查询按钮\r\n\t$('.btn').on('click', function () {\r\n\t\tvar oCont = $('.cont.active');\r\n\t\tvar oDate = new Date();\r\n\t\tvar year = oDate.getFullYear();\r\n\t\tvar dateStr = year + '-' + oCont.find('.date .time li.active').attr('data-time');\r\n\t\tvar arrdep;\r\n\t\tif (oCont.hasClass('flight')) {\r\n\t\t\tarrdep = $('.arrdep li.active').attr('data-arrdep');\r\n\t\t\tvar flightNo = oCont.find('.flightno input').val();\r\n\t\t\tvar reg = /^(\\w{2})?[0-9]{3,4}([a-zA-Z]{1})?$/g;\r\n\t\t\tif (reg.test(flightNo) && flightNo != \"\") {\r\n\t\t\t\twindow.location.href = 'list.html?flightNo=' + flightNo + '&arrdep=' + arrdep + '&dateStr=' + dateStr + '&type=flight';\r\n\t\t\t} else {\r\n\t\t\t\tdialogA.show(); // 显示弹窗\r\n\t\t\t\tdialogA.setValue('', '请输入正确的航班号');\r\n\t\t\t\t// 请输入正确的航班号\r\n\t\t\t};\r\n\t\t} else if (oCont.hasClass('city')) {\r\n\t\t\tif ($('.address .depart input').val() == '重庆') {\r\n\t\t\t\tarrdep = 'dep';\r\n\t\t\t} else {\r\n\t\t\t\tarrdep = 'arr';\r\n\t\t\t}\r\n\t\t\tvar startStation = oCont.find('.depart input').attr('data-code');\r\n\t\t\tvar endStation = oCont.find('.dest input').attr('data-code');\r\n\t\t\tvar airLine = $('.cont .company input').attr('data-code');\r\n\t\t\twindow.location.href = 'list.html?startStation=' + startStation + '&endStation=' + endStation + '&arrdep=' + arrdep + '&dateStr=' + dateStr + '&airLine=' + airLine + '&type=city';\r\n\t\t}\r\n\t});\r\n\t//城市选择\r\n\t$('.select').on('click', function () {\r\n\t\twindow.location.href = 'city.html' + window.location.search;\r\n\t});\r\n\t$('.company input').on('click', function () {\r\n\t\twindow.location.href = 'company.html' + window.location.search;\r\n\t});\r\n\t$('.company span').on('click', function () {\r\n\t\t$('.company input').val('');\r\n\t\t$('.company input').attr({\r\n\t\t\t'data-code': ''\r\n\t\t});\r\n\t\tsessionStorage.setItem('company', null);\r\n\t\t$('.company span').hide();\r\n\t});\r\n\t// 点击跳转关注列表\r\n\t$(\".follow .list\").on('click', 'li', function () {\r\n\t\tvar fltId = $(this).attr('data-fltid');\r\n\t\tvar arrdep = $(this).attr('arrdep');\r\n\t\twindow.location.href = 'detail.html?fltId=' + fltId + '&arrdep=' + arrdep;\r\n\t});\r\n});\r\n\r\n/*\r\n *创建日期\r\n *格式化好的一组时间对象\r\n */\r\nfunction createDate(json) {\r\n\tvar oLi = $('<li data-time=' + json.time + ' class=' + json.sClass + '>' +\r\n\t\t'<p class=\"day\">' + json.day + '</p>' +\r\n\t\t'<p class=\"month\">' + json.mon + '</p></li>');\r\n\toLi.appendTo($('.cont .date .time'));\r\n}\r\n\r\nfunction formatsTime(time, sClass) {\r\n\tvar monArr = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月',\r\n\t\t'九月', '十月', '十一月', '十二月',\r\n\t];\r\n\tvar oDate = new Date();\r\n\toDate.setTime(time);\r\n\tvar mon = oDate.getMonth();\r\n\tvar day = oDate.getDate();\r\n\treturn {\r\n\t\tmon: monArr[mon],\r\n\t\tday: day,\r\n\t\tsClass: sClass,\r\n\t\ttime: (mon + 1) + '-' + day\r\n\t};\r\n}\r\n// 获取关注列表\r\nfunction follow(json) {\r\n\tconsole.log(json);\r\n\tvar dep = json.depList;\r\n\tvar arr = json.arrList;\r\n\tvar list = [];\r\n\tvar str = \"<ul>\";\r\n\tvar arrdep = '';\r\n\tif (dep != null) {\r\n\t\tfor (var q in dep) {\r\n\t\t\tlist.push(dep[q])\r\n\t\t}\r\n\t};\r\n\tif (arr != null) {\r\n\t\tfor (var k in arr) {\r\n\t\t\tlist.push(arr[k])\r\n\t\t}\r\n\t};\r\n\tfor (var i in list) {\r\n\t\tcode = list[i].airlineCode || list[i].iata;\r\n\t\tflt = list[i].fltNo || '';\r\n\t\tvar status;\r\n\t\tif (list[i].releaseStatus1 == undefined) {\r\n\t\t\tstatus = '计划';\r\n\t\t} else {\r\n\t\t\tstatus = list[i].releaseStatus1;\r\n\t\t}\r\n\t\tif (list[i].airlineCode != null) {\r\n\t\t\tarrdep = 'arr';\r\n\t\t} else {\r\n\t\t\tarrdep = 'dep';\r\n\t\t};\r\n\t\tvar oLi = $('<li arrdep=' + arrdep + ' data-fltId=' + list[i].identification + '>\\\r\n\t\t\t<div class=\"title clearfix\">\\\r\n\t\t\t\t<p class=\"icon fl\"></p>\\\r\n\t\t\t\t<p class=\"fl name\">' + list[i].iataCn + code + flt + '</p>\\\r\n\t\t\t</div>\\\r\n\t\t\t<div class=\"detail clearfix\">\\\r\n\t\t\t\t<div class=\"fl\">\\\r\n\t\t\t\t\t<p class=\"time\">' + list[i].sdtTime + '</p>\\\r\n\t\t\t\t\t<p class=\"city\">' + list[i].startAirportNameCn + '</p>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t\t<p class=\"status fl\">' + status + '</p>\\\r\n\t\t\t\t<div class=\"fl\">\\\r\n\t\t\t\t\t<p class=\"time\">' + list[i].destSdtTime + '</p>\\\r\n\t\t\t\t\t<p class=\"city\">' + list[i].destAirportNameCn + '</p>\\\r\n\t\t\t\t</div>\\\r\n\t\t\t</div>\\\r\n\t\t</li>');\r\n\t\toLi.appendTo($('.list ul'));\r\n\t\tvar color = getStateColor(status);\r\n\t\toLi.find('.status').css({\r\n\t\t\tcolor: color\r\n\t\t});\r\n\t\toLi.find('.title .icon').css({\r\n\t\t\t'background': 'url(images/' + code + '.gif) no-repeat',\r\n\t\t\t'backgroundSize': 'contain'\r\n\t\t});\r\n\t};\r\n}"]}