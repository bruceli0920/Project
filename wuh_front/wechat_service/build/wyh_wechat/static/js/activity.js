function getDescQueryString(t,e){var i=new RegExp("(^||)"+e+":([^|]*)(||$)"),s=t.match(i);return null!=s?unescape(s[2]):null}function Mathrandom(t,e){var i=e-t+1;return Math.floor(Math.random()*i+t)}function saveAddCardRecord(t){window.isBusy=!1,ajaxBase({url:"/aup/api/wechat/card/addCard",data:cardList})}function advertising(){var t="string"==typeof getUrlQueryString("rate")?getUrlQueryString("rate"):"0",e=getUrlQueryString("adcount")||1,i=Mathrandom(1,10)/10,s="";(void 0!=$("#sing_iframe").attr("src")&&$("#sing_iframe").remove(),$("#sing").css({display:"none"}),i>=t)?($("#iframe",parent.document).siblings("#sing").css("display")&&$("#iframe",parent.document).siblings("#sing").css({display:"none"}),logdata_num=Mathrandom(1,e),s='<iframe id="sing_iframe" src="'+("advertising/sing_"+logdata_num+".html")+'"></iframe>',$("#sing").append(s),$("#sing").css({display:"block"})):$("#iframe",parent.document).siblings("#sing").css({display:"block"})}function showTicket(t,e){if(logdata_num=-1,_st=setTimeout(function(){window.isBusy=t},100),t){if(e&&e.desc){if(e.desc.indexOf("http")>=0&&e.desc.indexOf("http")<10)return void(window.location.href=e.desc);clearTimeout(_st),window.isBusy=!1,cardList.cardId=getDescQueryString(e.desc,"cardid"),cardList.cardCode=e.qr,cardList.flag=getDescQueryString(e.desc,"flag"),cardList.sourceid=getDescQueryString(e.desc,"sourceid"),"Y"==cardList.flag?wxaddCard({cardId:cardList.cardId,code:cardList.cardCode,ready:saveAddCardRecord}):wxaddCard({cardId:cardList.cardId,code:"",ready:saveAddCardRecord}),logdata.giftType=_giftType,logdata.promoStatus=30,logdata.cardId=cardList.cardId,logdata.cardCode=cardList.cardCode}}else advertising(),logdata.promoStatus=40,logdata.giftType=4,logdata.giftDetail=logdata_num||"";window.parent.promoLog(logdata)}function box(){var t=getUrlQueryString("op"),e=t?t.split(",")[0]:getUrlQueryString("userid")||getUrlQueryString("userId")||getUrlQueryString("o"),i=(t?t.split(",")[1]:getUrlQueryString("promoid")||getUrlQueryString("promoId")||getUrlQueryString("p"))||15232,s=(s=getUrlQueryString("type"))&&"luck"!=s?"coupon":"luck",n=getUrlQueryString("code")||getUrlQueryString("airportCode")||"PEK",r=String("luck"==s?"http://182.92.31.114/":"http://101.201.176.54/")+"rest/act/"+i+"/"+String(e)+"?"+window.location.href.split("?")[1];_giftType=getUrlQueryString("giftType")||4,logdata={promoId:i,promoType:1,promoStatus:0,giftType:_giftType,cardId:"",cardCode:"",giftDetail:""},cardList={openId:e,cardId:"",cardCode:"",flag:"",sourceid:"",airportCode:n},wxInit({apiList:"addCard"});var o=new Shake({threshold:8});window.isBusy=!1,o.start(),window.addEventListener("shake",function(){isBusy||(window.isBusy=!0,JSONP({url:r,success:function(t){showTicket(!Boolean(Number(t.code)),t)},error:function(t){showTicket(!1)}}))},!1)}!function(t,e){"function"==typeof define&&define.amd?define(function(){return e(t,t.document)}):"undefined"!=typeof module&&module.exports?module.exports=e(t,t.document):t.Shake=e(t,t.document)}("undefined"!=typeof window?window:this,function(t,e){function i(i){if(this.hasDeviceMotion="ondevicemotion"in t,this.options={threshold:15,timeout:1e3},"object"==typeof i)for(var s in i)i.hasOwnProperty(s)&&(this.options[s]=i[s]);if(this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof e.CustomEvent)this.event=new e.CustomEvent("shake",{bubbles:!0,cancelable:!0});else{if("function"!=typeof e.createEvent)return!1;this.event=e.createEvent("Event"),this.event.initEvent("shake",!0,!0)}}return i.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},i.prototype.start=function(){this.reset(),this.hasDeviceMotion&&t.addEventListener("devicemotion",this,!1)},i.prototype.stop=function(){this.hasDeviceMotion&&t.removeEventListener("devicemotion",this,!1),this.reset()},i.prototype.devicemotion=function(e){var i,s,n,r=e.accelerationIncludingGravity;if(null===this.lastX&&null===this.lastY&&null===this.lastZ)return this.lastX=r.x,this.lastY=r.y,void(this.lastZ=r.z);i=Math.abs(this.lastX-r.x),s=Math.abs(this.lastY-r.y),n=Math.abs(this.lastZ-r.z),(i>this.options.threshold&&s>this.options.threshold||i>this.options.threshold&&n>this.options.threshold||s>this.options.threshold&&n>this.options.threshold)&&(new Date).getTime()-this.lastTime.getTime()>this.options.timeout&&(t.dispatchEvent(this.event),this.lastTime=new Date),this.lastX=r.x,this.lastY=r.y,this.lastZ=r.z},i.prototype.handleEvent=function(t){if("function"==typeof this[t.type])return this[t.type](t)},i});
//# sourceMappingURL=maps/activity.js.map
