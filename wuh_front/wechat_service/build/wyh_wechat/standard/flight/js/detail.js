var arrdep=getUrlQueryString("arrdep");function createDetail(a,t){var i,l,e,s=a.fltInfo,n=a.subscribeStatus,r=s.identification.split("-")[2],o=r.substring(0,4)+"-"+r.substring(4,6)+"-"+r.substring(6,8),c={},p={},d=s.identification,u=d.substring(d.length-1);if(e=s.releaseStatus1?s.releaseStatus1:"计划",s.actTime?(c.name="实际起飞",c.value=s.actTime):s.estTime?(c.name="预计起飞",c.value=s.estTime):(c.name="预计起飞",c.value="-"),s.destActTime?(p.name="实际到达",p.value=s.destActTime):s.destEstTime?(p.name="预计到达",p.value=s.destEstTime):(p.name="预计到达",p.value="-"),"arr"==arrdep){i=s.airlineCode,bltDisp=s.bltDisp||"-",bltOt=s.bltOt||"-";var f=[{name:"行李转盘",value:bltDisp},{name:"转盘开放时间",value:bltOt},{name:"出租车等待时长",value:"-"}]}else if("dep"==arrdep){i=s.iata,cntDisp=s.cntDisp||"-",gateDisp=s.gateDisp||"-";try{firstGatOt=s.firstGatOt.slice(11,s.firstGatOt.length).slice(0,5)||"-"}catch(a){firstGatOt="-"}f=[{name:"登机口开放时间",value:firstGatOt},{name:"登机口",value:gateDisp},{name:"安检排队时长",value:"-"}]}if(l="Y"==n?"取消关注":"关注航班",s.flightNoStr.indexOf(",")>0){var v=s.flightNoStr.indexOf(",");s.flightNoStr=s.flightNoStr.slice(v+1);s.flightNoStr=s.flightNoStr.replace(new RegExp(",","gm"),"&nbsp;&nbsp;&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";var m=$('<div class="top clearfix"><div class="left fl" style="float:none;margin:0 auto;border-right:0;"><div class="date">'+o+'</div><div class="clearfix address"><p class="fl start">'+s.startAirportNameCn+'<span class="ter1">'+s.terminal+'</span></p><p class="fl icon"></p><p class="fl dest">'+s.destAirportNameCn+'<span class="ter2">'+s.terminal+'</span></p></div></div></div><div class="cont"><div class="title clearfix"><p class="fl icon"></p><p class="fl">'+s.iataCn+i+s.fltNo+'</p><div class="f2"><span class="sharename">共享航班:</span><span class="shareflt"><span class="sharefltcon">'+s.flightNoStr+'</span></span></div></div><div class="time"><ul><li><p>'+c.name+"</p><p>"+c.value+"</p><p>计划："+s.sdtTime+"</p></li><li><p>"+p.name+"</p><p>"+p.value+"</p><p>计划："+s.destSdtTime+'</p></li></ul><p class="status">'+e+'</p></div><div class="tip"><ul><li><p class="value">'+f[0].value+'</p><p class="name">'+f[0].name+'</p></li><li><p class="value">'+f[1].value+'</p><p class="name">'+f[1].name+'</p></li></ul></div></div><div class="bottom"><ul class="clearfix"><li class="guanzhu">'+l+"</li></ul></div>")}else m=$('<div class="top clearfix"><div class="left fl" style="float:none;margin:0 auto;border-right:0;"><div class="date">'+o+'</div><div class="clearfix address"><p class="fl start">'+s.startAirportNameCn+'<span class="ter1">'+s.terminal+'</span></p><p class="fl icon"></p><p class="fl dest">'+s.destAirportNameCn+'<span class="ter2">'+s.terminal+'</span></p></div></div></div><div class="cont"><div class="title clearfix"><p class="fl icon"></p><p class="fl">'+s.iataCn+i+s.fltNo+'</p></div><div class="time"><ul><li><p>'+c.name+"</p><p>"+c.value+"</p><p>计划："+s.sdtTime+"</p></li><li><p>"+p.name+"</p><p>"+p.value+"</p><p>计划："+s.destSdtTime+'</p></li></ul><p class="status">'+e+'</p></div><div class="tip"><ul><li><p class="value">'+f[0].value+'</p><p class="name">'+f[0].name+'</p></li><li><p class="value">'+f[1].value+'</p><p class="name">'+f[1].name+'</p></li></ul></div></div><div class="bottom"><ul class="clearfix"><li class="guanzhu">'+l+"</li></ul></div>");var g=getStateColor(e);m.find(".status").css({color:g}),m.find(".title .icon").css({background:"url(images/"+i+".gif)",backgroundSize:"contain"}),m.appendTo($(".g-wrap"));var h=$(".shareflt").outerWidth();$(".shareflt span").outerWidth()>h&&$(".shareflt").liMarquee({scrollamount:20,hoverstop:!1}),"D"==u?($(".ter1").show(),$(".ter2").hide(),$(".guanzhu").after("<li class='fl guide'>登机引导</li>"),m.find(".guanzhu").addClass("btnstyle"),m.find(".guide").addClass("btnstyle"),m.find(".guide").html("登机引导"),m.find(".guide").on("click",function(){var a=s.iata+s.fltNo,i=s.cntTerminalNo;void 0===i&&(i="T2"),ajaxBase({url:"http://10.10.11.21:8989/api/flight/getBoardingLead?token="+t,data:{fltNo:a,cntTerminalNo:i},success:function(a){localStorage.removeItem("locations"),localStorage.locations=JSON.stringify(a);var t="";if(void 0!=a){for(var i=0;i<a.length;i++)t+=JSON.stringify(a[i])+"&";localStorage.removeItem("locations"),localStorage.setItem("locations",t),localStorage.point=""}!function(a){var t=a;if("D"==u&&void 0!=t){var i=t[0].buildingId;if(3==t.length)window.location.href="map/index.html?key=k7i23869hd&buildid="+i+"&labelstyle=circle-point";else if(1==t.length){var l=t.locations[0];localStorage.locations="",localStorage.point=JSON.stringify(l),m.find(".guide").html("登机口位置"),window.location.href="map/index.html?key=k7i23869hd&buildid="+i+"&labelstyle=circle-point&floor="+l.floor+"&center=["+l.xCoord+","+l.yCoord+"]&zoom=19"}}else m.find(".guide").hide()}(a)}},!1)})):($(".ter1").hide(),$(".ter2").show())}$(document).ready(function(){var a=getUrlQueryString("fltId"),t=sessionStorage.getItem("token");ajaxBase({url:"http://10.10.11.21:8989/api/flight/getFltDetial?token="+t,data:{identification:a},success:function(a){createDetail(a,t)}}),$(".g-wrap").on("click",".guanzhu",function(){if("关注航班"==$(this).html())var i={url:"http://10.10.11.21:8989/api/subscribe/followFlight?token="+t,data:{identification:a},success:function(a){location.reload()}};else i={url:"http://10.10.11.21:8989/api/subscribe/unfollowFlight?token="+t,data:{identification:a},success:function(a){location.reload()}};ajaxBase(i)})});
//# sourceMappingURL=maps/detail.js.map
