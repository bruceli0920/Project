function createDate(t){$("<li data-time="+t.time+" class="+t.sClass+'><p class="day">'+t.day+'</p><p class="month">'+t.mon+"</p></li>").appendTo($(".cont .date .time"))}function formatsTime(t,e){var a=new Date;a.setTime(t);var s=a.getMonth(),i=a.getDate();return{mon:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][s],day:i,sClass:e,time:s+1+"-"+i}}function follow(t){var e=t.depList,a=t.arrList;$(".list ul").html("");var s=[],i="";if(null!=e)for(var o in e)s.push(e[o]);if(null!=a)for(var n in a)s.push(a[n]);for(var l in s){var r;code=s[l].airlineCode||s[l].iata,flt=s[l].fltNo||"",r=void 0==s[l].releaseStatus1?"计划":s[l].releaseStatus1,i=null!=s[l].airlineCode?"arr":"dep";var c=s[l].identification;if("D"==c.substring(c.length-1))var d=$("<li arrdep="+i+" data-fltId="+s[l].identification+'>\t\t\t<div class="title clearfix">\t\t\t\t<p class="icon fl"></p>\t\t\t\t<p class="fl name">'+s[l].iataCn+code+flt+'</p>\t\t\t</div>\t\t\t<div class="detail clearfix">\t\t\t\t<div class="fl">\t\t\t\t\t<p class="time">'+s[l].sdtTime+'</p>\t\t\t\t\t<p class="city">'+s[l].startAirportNameCn+'<span class="ter1">'+s[l].terminal+'</span></p>\t\t\t\t</div>\t\t\t\t<p class="status fl">'+r+'</p>\t\t\t\t<div class="fl">\t\t\t\t\t<p class="time">'+s[l].destSdtTime+'</p>\t\t\t\t\t<p class="city">'+s[l].destAirportNameCn+"</p>\t\t\t\t</div>\t\t\t</div>\t\t</li>");else d=$("<li arrdep="+i+" data-fltId="+s[l].identification+'>\t\t\t<div class="title clearfix">\t\t\t\t<p class="icon fl"></p>\t\t\t\t<p class="fl name">'+s[l].iataCn+code+flt+'</p>\t\t\t</div>\t\t\t<div class="detail clearfix">\t\t\t\t<div class="fl">\t\t\t\t\t<p class="time">'+s[l].sdtTime+'</p>\t\t\t\t\t<p class="city">'+s[l].startAirportNameCn+'</p>\t\t\t\t</div>\t\t\t\t<p class="status fl">'+r+'</p>\t\t\t\t<div class="fl">\t\t\t\t\t<p class="time">'+s[l].destSdtTime+'</p>\t\t\t\t\t<p class="city">'+s[l].destAirportNameCn+'<span class="ter2">'+s[l].terminal+"</span></p>\t\t\t\t</div>\t\t\t</div>\t\t</li>");d.appendTo($(".list ul"));var p=getStateColor(r);d.find(".status").css({color:p}),d.find(".title .icon").css({background:"url(images/"+code+".gif) no-repeat",backgroundSize:"contain"})}}$(document).ready(function(){dialogA=Dialog.init("alert");var t=sessionStorage.getItem("token")||getUrlQueryString("token");setSessionValue("token",t);var e=sessionStorage.getItem("reverse")||"false";setSessionValue("reverse",e);var a=sessionStorage.getItem("month")||"";setSessionValue("month",a),sessionStorage.getItem("city")&&($(".select").val(sessionStorage.getItem("city")),$(".select").attr({"data-code":sessionStorage.getItem("cityCode")}),$(".tab li").removeClass("active"),$(".tab li").eq(1).addClass("active"),$(".cont").removeClass("active"),$(".cont").eq(1).addClass("active")),sessionStorage.getItem("company")&&($(".depart input").val("重庆"),$("#company").val(sessionStorage.getItem("company")),$("#company").attr({"data-code":sessionStorage.getItem("companyCode")}),$(".company span").show(),$(".tab li").removeClass("active"),$(".tab li").eq(1).addClass("active"),$(".cont").removeClass("active"),$(".cont").eq(1).addClass("active")),"null"==sessionStorage.getItem("company")&&$("#company").val(""),"true"==sessionStorage.getItem("reverse")&&($(".address .depart input").appendTo($(".address .dest")),$(".address .dest input").eq(0).appendTo($(".address .depart"))),$(".tab li").each(function(e){$(this).on("click",function(){($(".msg").hide(),$(".tab li").removeClass("active"),$(this).addClass("active"),$(".cont").removeClass("active"),$(".cont").eq(e).addClass("active"),2==e)?(ajaxBase({url:"http://10.10.11.21:8989/api/subscribe/getFollowList?token="+t,success:function(t){follow(t),console.log(t),console.log(t.hasOwnProperty("depList")),0==t.hasOwnProperty("depList")&&0==t.hasOwnProperty("arrList")&&$(".msg").show()}}),$(".btn").hide()):$(".btn").show()})}),ajaxBase({url:"http://10.10.11.21:8989/api/flight/getServerTime?token="+t,success:function(t){for(var e=Math.floor(t.time),a=-1;a<2;a++){createDate(0==a?formatsTime(e,"active"):formatsTime(e+864e5*a,1==a?"none":""))}}},!1),$(".date .arrdep li").on("click",function(){$(".date .arrdep li").removeClass("active"),$(this).addClass("active")}),$(".date .time").on("click","li",function(){$(this).parents(".cont").find(".date .time li").removeClass("active"),$(this).addClass("active")}),$(".city .address .cut").on("click",function(){"false"==sessionStorage.getItem("reverse")?setSessionValue("reverse","true"):setSessionValue("reverse","false"),$(".address .depart input").appendTo($(".address .dest")),$(".address .dest input").eq(0).appendTo($(".address .depart"))}),$(".btn").on("click",function(){var t,e=$(".cont.active"),a=(new Date).getFullYear()+"-"+e.find(".date .time li.active").attr("data-time");if(e.hasClass("flight")){t=$(".arrdep li.active").attr("data-arrdep");var s=e.find(".flightno input").val();/^(\w{2})?[0-9]{2,4}([a-zA-Z]{1})?$/g.test(s)&&""!=s?window.location.href="list.html?flightNo="+s+"&arrdep="+t+"&dateStr="+a+"&type=flight":(dialogA.show(),dialogA.setValue("","请输入正确的航班号"))}else if(e.hasClass("city")){t="重庆"==$(".address .depart input").val()?"dep":"arr";var i=e.find(".depart input").attr("data-code"),o=e.find(".dest input").attr("data-code"),n=$(".cont .company input").attr("data-code");window.location.href="list.html?startStation="+i+"&endStation="+o+"&arrdep="+t+"&dateStr="+a+"&airLine="+n+"&type=city"}}),$(".select").on("click",function(){window.location.href="city.html"+window.location.search}),$(".company input").on("click",function(){window.location.href="company.html"+window.location.search}),$(".company span").on("click",function(){$(".company input").val(""),$(".company input").attr({"data-code":""}),sessionStorage.setItem("company",null),$(".company span").hide()}),$(".follow .list").on("click","li",function(){var t=$(this).attr("data-fltid"),e=$(this).attr("arrdep");window.location.href="detail.html?fltId="+t+"&arrdep="+e})});
//# sourceMappingURL=maps/portal.js.map
