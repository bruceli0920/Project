{"version":3,"sources":["list.js"],"names":["createList","arr","console","log","i","length","status","icon","json","undefined","releaseStatus1","iata","airlineCode","fltiden","identification","fltStrarr","substring","flightNoStr","indexOf","x","slice","replace","RegExp","oLi","$","iataCn","fltNo","sdtTime","startAirportNameCn","terminal","destSdtTime","destAirportNameCn","appendTo","color","getStateColor","find","css","background","backgroundSize","boxWS","outerWidth","liMarquee","scrollamount","hoverstop","show","hide","document","ready","bFlag","type","getUrlQueryString","arrdep","dateStr","token","sessionStorage","getItem","cityJson","flightNo","ajaxBase","url","data","date","arrOrDep","success","startStation","endStation","airLine","pageNum","pageCount","rst","lastPage","totalCount","on","fltId","this","attr","window","location","href","oList","scroll","scrollTop","clientHeight","documentElement","body","top","outerHeight"],"mappings":"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","file":"../list.js","sourcesContent":["//var arrdep=getUrlQueryString('arrdep');\r\n$(document).ready(function () {\r\n\tvar bFlag = true;\r\n\tvar type = getUrlQueryString('type');\r\n\tvar arrdep = getUrlQueryString('arrdep');\r\n\tvar dateStr = getUrlQueryString('dateStr');\r\n\tvar token = sessionStorage.getItem('token');\r\n\tvar pageNum = 1;\r\n\tvar pageCount = 10;\r\n\tvar flightJson = {};\r\n\tvar cityJson = {};\r\n\tif (type == 'flight') {\r\n\t\tvar flightNo = getUrlQueryString('flightNo');\r\n\t\tflightJson = {\r\n\t\t\turl: 'http://10.10.11.21:8989/api/flight/selectByFlightNoAndDate?token=' + token,\r\n\t\t\tdata: {\r\n\t\t\t\t\"flightNo\": flightNo,\r\n\t\t\t\t\"date\": dateStr,\r\n\t\t\t\t\"arrOrDep\": arrdep\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (data && data.length != 0) {\r\n\t\t\t\t\tbFlag = true;\r\n\t\t\t\t\tcreateList(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('.msg').hide();\r\n\t\t\t\t\t// $('.msg.none').show();\r\n\t\t\t\t\t$('.cqmsg').show();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tajaxBase(flightJson, false);\r\n\t} else if (type == 'city') {\r\n\t\tvar startStation = getUrlQueryString('startStation');\r\n\t\tvar endStation = getUrlQueryString('endStation');\r\n\t\tvar airLine = getUrlQueryString('airLine');\r\n\t\tcityJson = {\r\n\t\t\turl: 'http://10.10.11.21:8989/api/flight/selectByStationAndDate?token=' + token,\r\n\t\t\tdata: {\r\n\t\t\t\t\"startStation\": startStation,\r\n\t\t\t\t\"endStation\": endStation,\r\n\t\t\t\t\"date\": dateStr,\r\n\t\t\t\t\"arrOrDep\": arrdep,\r\n\t\t\t\t\"pageNum\": pageNum,\r\n\t\t\t\t\"pageCount\": pageCount,\r\n\t\t\t\t\"airLine\": airLine\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (data && data.length != 0) {\r\n\t\t\t\t\tbFlag = true;\r\n\t\t\t\t\tcreateList(data.rst);\r\n\t\t\t\t\tif (data.lastPage || data.rst.length == 0) {\r\n\t\t\t\t\t\tbFlag = false;\r\n\t\t\t\t\t\t$('.msg').hide();\r\n\t\t\t\t\t\t// $('.msg.none').show()\r\n\t\t\t\t\t\tif (data.totalCount == 0){\r\n\t\t\t\t\t\t\t$('.cqmsg').show();\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('.msg').hide();\r\n\t\t\t\t\t// $('.msg.none').show()\r\n\t\t\t\t\t$('.cqmsg').show();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tajaxBase(cityJson, false);\r\n\t}\r\n\t$('.list ul').on('click', 'li', function () {\r\n\t\tvar fltId = $(this).attr('data-fltId');\r\n\t\twindow.location.href = 'detail.html?fltId=' + fltId + '&arrdep=' + arrdep;\r\n\t});\r\n\tvar oList = $('.list');\r\n\tvar oUl = $('.list ul');\r\n\t$(document).scroll(function () {\r\n\t\tvar scrollTop = $(document).scrollTop();\r\n\t\tvar clientHeight = document.documentElement ? document.documentElement.clientHeight : document.body.clientHeight;\r\n\t\tvar top = oList.outerHeight();\r\n\t\tvar aBtn = $('.tab li');\r\n\t\tvar h = scrollTop + clientHeight;\r\n\t\tif (h + 100 >= top && scrollTop > 100) {\r\n\t\t\tif (bFlag) {\r\n\t\t\t\tbFlag = false;\r\n\t\t\t\tif (type == 'city') {\r\n\t\t\t\t\tcityJson.data.pageNum++;\r\n\t\t\t\t\tajaxBase(cityJson, false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n});\r\n\r\nfunction createList(arr) {\r\n\tconsole.log(arr)\r\n\tfor (var i = 0; i < arr.length; i++) {\r\n\t\tvar json = arr[i];\r\n\t\tvar status;\r\n\t\tif (json.releaseStatus1 == undefined) {\r\n\t\t\tstatus = '计划';\r\n\t\t} else {\r\n\t\t\tstatus = json.releaseStatus1;\r\n\t\t}\r\n\t\tvar icon;\r\n\t\tif (json.iata != undefined) {\r\n\t\t\ticon = json.iata;\r\n\t\t} else if (json.airlineCode != undefined) {\r\n\t\t\ticon = json.airlineCode;\r\n\t\t}\r\n\t\tvar fltiden = json.identification;\r\n\t\t// TODO判断是否到达\r\n\t\tvar fltStrarr = fltiden.substring(fltiden.length - 1)\r\n\t\tif (json.flightNoStr.indexOf(\",\") > 0) {\r\n\t\t\tvar x = json.flightNoStr.indexOf(\",\");\r\n\t\t\tjson.flightNoStr=json.flightNoStr.slice(x+1)\r\n\t\t\tvar replaceStr = ',';\r\n\t\t\tjson.flightNoStr=json.flightNoStr.replace(new RegExp(replaceStr,'gm'),'&nbsp;&nbsp;&nbsp;')+\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\r\n\t\t\t// json.flightNoStr=json.flightNoStr.slice(x+1)+\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\"\r\n\t\t\tvar oLi = $('<li data-fltId=' + json.identification + '>' +\r\n\t\t\t'<div class=\"title clearfix\">' +\r\n\t\t\t'<i class=\"icon fl\"></i>' +\r\n\t\t\t'<p class=\"fl\">' + json.iataCn + icon + json.fltNo + '</p>' +\r\n\t\t\t'<div class=\"f2\"><span class=\"sharename\">共享航班:</span><span class=\"shareflt\"><span class=\"sharefltcon\">'+json.flightNoStr+'</span></span></div>'+\r\n\t\t\t'</div>' +\r\n\t\t\t'<div class=\"detail clearfix\">' +\r\n\t\t\t'<div class=\"fl\">' +\r\n\t\t\t'<p class=\"time\">' + json.sdtTime + '</p>' +\r\n\t\t\t'<p class=\"city\">' + json.startAirportNameCn +'<span class=\"ter1\">'+json.terminal+'</span>'+ '</p>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'<p class=\"status fl\">' + status + '</p>' +\r\n\t\t\t'<div class=\"fl\">' +\r\n\t\t\t'<p class=\"time\">' + json.destSdtTime + '</p>' +\r\n\t\t\t'<p class=\"city\">' + json.destAirportNameCn + '<span class=\"ter2\">'+json.terminal+'</span>'+ '</p>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'<div class=\"view\">查看详情</div>' +\r\n\t\t\t'</li>');\r\n\t\t} else { \r\n\t\t\tvar oLi = $('<li data-fltId=' + json.identification + '>' +\r\n\t\t\t'<div class=\"title clearfix\">' +\r\n\t\t\t'<i class=\"icon fl\"></i>' +\r\n\t\t\t'<p class=\"fl\">' + json.iataCn + icon + json.fltNo + '</p>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'<div class=\"detail clearfix\">' +\r\n\t\t\t'<div class=\"fl\">' +\r\n\t\t\t'<p class=\"time\">' + json.sdtTime + '</p>' +\r\n\t\t\t'<p class=\"city\">' + json.startAirportNameCn +'<span class=\"ter1\">'+json.terminal+'</span>'+ '</p>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'<p class=\"status fl\">' + status + '</p>' +\r\n\t\t\t'<div class=\"fl\">' +\r\n\t\t\t'<p class=\"time\">' + json.destSdtTime + '</p>' +\r\n\t\t\t'<p class=\"city\">' + json.destAirportNameCn + '<span class=\"ter2\">'+json.terminal+'</span>'+ '</p>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'</div>' +\r\n\t\t\t'<div class=\"view\">查看详情</div>' +\r\n\t\t\t'</li>');\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\toLi.appendTo($('.list ul'));\r\n\t\tvar color = getStateColor(status);\r\n\t\toLi.find('.status').css({\r\n\t\t\tcolor: color\r\n\t\t});\r\n\t\toLi.find('.title .icon').css({\r\n\t\t\t'background': 'url(images/' + icon + '.gif) no-repeat',\r\n\t\t\t'backgroundSize': 'contain'\r\n\t\t});\r\n\t\tvar boxWS = oLi.find('.shareflt').outerWidth();\r\n\t\tvar contWS = oLi.find('.shareflt span').outerWidth();\r\n\t\t// console.log('boxWS==='+boxWS+'contWS===='+contWS);\r\n\t\tif (contWS > boxWS) {\r\n\t\t\t\toLi.find('.shareflt').liMarquee({\r\n\t\t\t\t\tscrollamount: 20,\r\n\t\t\t\t\thoverstop: false\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (fltStrarr == \"D\"){\r\n\t\t\t$(\".ter1\").show();\r\n\t\t\t$(\".ter2\").hide();\r\n\t\t} else {\r\n\t\t\t$(\".ter1\").hide();\r\n\t\t\t$(\".ter2\").show();\r\n\t\t}\t\t\r\n\t}\r\n\r\n}"]}